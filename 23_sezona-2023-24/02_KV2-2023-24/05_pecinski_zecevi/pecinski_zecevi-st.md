---
title: Пећински зечеви
timelimit: 1.0 # у секундама
memlimit: 64   # y MB
owner: takprog # власник је онај ко ради на задатку
origin: # опционо (ако се зна одакле је задатак преузет, пожељно је навести извор)
tags: [] # сваки задатак може бити означен према унапред договореној листи ознака
status: KOMPLETAN # један од: "IZRADA", "PREGLED" или "KOMPLETAN".
status-date: 2024-08-15 # датум у формату YYYY-MM-DD од када је задатак у наведеном статусу
crafted-dir: testcases
solutions:
  - name: ex0
    lang: [cpp]
    desc: ""
    tags: []
---

Као што је опште познато у години $3023$, зечеви немају бркове, ослепели су, имају три пута веће уши и живе у пећинама. У једној пећини налати се $N$ соба, а у свакој се налази по један зец. Познато је да су неке собе повезане пролазима. Постоји $N-1$ парова таквих соба. $i$-ти пар описује да је соба $U_i$ директно изнад собе $V_i$. Могуће је од собе $V_i$ тим пролазом стићи до собе $U_i$. Соба $1$ је посебна. Изнад ње се не налази ниједна соба, већ излаз из пећине. Изнад сваке остале собе се налази друга соба. Познато је да је из сваке собе могуће стићи до собе $1$ крећући се пролазима.

Промена магнетних полова земље изазвала је непревиђена сеизмичка дешавања. Пећина је под земљотресом, и потребно је евакуисати све зечеве. Они су нумерисани бројевима од $1$ до $N$. $i$-ти зец се налази у соби $i$ и има снагу $i$. Како би зечеви изашли из пећине, они могу да скачу нагоре. Тачније, могу скочити у било коју собу која је директно изнад тренутне, на ону која је изнад ње, на ону изнад ње итд. Услов је да $i$-ти зец снаге $i$ може скочити највише $i$ соба нагоре (одједном). Зечеви могу скакати више пута, али неопходно је у што мање скокова изаћи из пећине. Такође, ако $i$-та соба „нагоре“ не постоји, то значи да зец одједном може да скочи довољно јако да изађе из пећине, те ће то учинити. Ако овај посао није већ био довољно компликован, земљотрес је пореметио приступачности соба. Тачније, кроз сваку собу је могуће проћи, али није нужно могуће доскочити на сваку собу. Само у неким собама се налази платформа за скакање (и само на њу је могуће доскочити).

Да не би правили гужву, зечеви су се договорили да излазе редом, од зеца $1$ до $N$. Пре него што зец $i$ крене у свој поход, због нестабилности пећине, може се десити једна од наредних $N+1$ ствари:

* Промени се стање собе $1$;
* Промени се стање собе $2$;
* Промени се стање собе $3$;
* $\ldots$
* Промени се стање собе $N$;
* Ништа се не мења.

Под променом стања подразумевамо да, ако је раније постојала платформа у соби, више не постоји, а ако раније није постојала, сада постоји.

За сваког зеца потребно је пронаћи најмањи број скокова потребан да он изађе из пећине. Може се десити да то није могуће и да ће, нажалост, он остати заглављен у пећини. Уколико се то деси, накнадно ће доћи екипа евакуационих глиста и избавити све заробљене зечеве. Потребно је објавити посебну поруку за све такве.

**Напомена**: може се десити да соба из које зец креће нема платформу за скакање. Он и даље може скакати на собе изнад. Услов је само да није могуће доскочити на собу без платформе.

## Опис улаза
У првом реду стандардног улаза, дат је цео број $N$ - број соба и број зечева.

У $i$-том од наредних $N-1$ редова, дата су два цела броја $U_i$ и $V_i$ - он обележава да постоји пролаз између те две собе, као и да је соба $U_i$ изнад собе $V_i$.

У претпостледњем реду стандардног улаза, дато је $N$ целих бројева $B_1, B_2, \ldots, B_N$. Ако је $B_i=1$, тада у соби $i$ постоји платформа за скакање (на почетку). Ако је $B_i=0$, онда не постоји у тој соби.

У последњем реду стандардног улаза, дато је $N$ целих бројева $X_1,X_2,\ldots, X_N$.
* Ако је $X_N = 0$, пре скока зеца $i$ ништа се не мења.
* Иначе, пре скока зеца $i$ мења се стање собе $X_i$.

## Опис излаза
У једној линији исписати $N$ бројева. $i$-ти број представља најмањи број скокова потребан да $i$-ти зец изађе из пећине. Уколико то не може учинити, за $i$-ти број поставити вредност $-1$.

## Ограничења
- $2 \leq N \leq 500\,000$
- $1 \leq U_i,V_i \leq N$, $U_i \neq V_i$, важе додатни услови повезаности соба описани у поставци задатка.
- $B_i \in \{ 0,1 \}$
- $0 \leq X_i \leq N$

Тест примери су подељени у пет дисјунктних група:
- У тестовима вредним 8 поена: Свака соба има највише једну испод ње, $X_i = 0$ за свако $i$.
- У тестовима вредним 24 поена: Свака соба има највише једну испод ње.
- У тестовима вредним 20 поена: $X_i = 0$ за свако $i$.
- У тестовима вредним 32 поена: $N \leq 100\,000$
- У тестовима вредним 16 поена: Без додатних ограничења.

## Пример 1
### Улаз
```
3
1 3
3 2
1 1 1
0 0 0
```

### Излаз
```
1 2 1
```

### Објашњење
У свакој соби налази се платформа за скакање и важи $X_1 = X_2 = X_3 = 0$. Тј. нема промена. Зец $1$ једним скоком може изаћи из пећине. Зец $2$ може прво скочити у собу $3$ која је изнад његове. Затим, може направити скок дужине два и искочити из пећине. За то му је укупно потребно два скока. Трећи зец може одједном направити скок којим излази из пећине.

## Пример 2
### Улаз
```
5
1 5
5 4
4 3
4 2
0 0 0 0 0
1 1 2 3 2
```

### Излаз
```
1 -1 -1 1 1 
```

### Објашњење
У овом примеру има промена. На почетку се ни у једној соби не налази платформа за скакање. Пре похода првог зеца мења се стање собе $1$, и тиме она добија платформу за скакање. Пре похода другог зеца опет се мења стање собе $1$, чиме она губи платформу. Када дође ред на зеца број $2$ да излази из пећине, он неће имати собу на коју може доскочити, а излаз из пећине му је предалек. Он не стиже да изађе из пећине, те ће га сачекати екипа евакуационих глиста. Пре похода зеца $3$ мења се стање собе $2$. Међутим, соба изнад њега, друга соба изнад њега, као и трећа соба изнад њега остају без платформе за скакање. То значи да ни он не може изаћи из пећине. Зечеви $4$ и $5$ могу одмах изаћи из пећине, те је одговор за њих $1$.

## Пример 3
### Улаз
```
2
1 2
0 0
1 1
```

### Излаз
```
1 1 
```

### Објашњење
У овом примеру сваки зец може одмах изаћи из пећине.

## Пример 4
### Улаз
```
16
1 16
16 7
16 8
7 15
15 14
14 13
13 12
12 11
12 10
10 9
10 5
10 6
6 2
6 3
14 4
0 1 0 1 1 0 1 0 1 1 1 0 1 1 0 0
1 16 15 12 13 14 9 4 6 7 12 15 13 13 16 15
```

### Излаз
```
1 6 4 2 2 2 1 1 1 1 1 1 1 1 1 1
```
