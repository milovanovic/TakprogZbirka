---
title: Обарање руку
timelimit: 1.0 # у секундама
memlimit: 64   # y MB
owner: takprog # власник је онај ко ради на задатку
origin: # опционо (ако се зна одакле је задатак преузет, пожељно је навести извор)
tags: [] # сваки задатак може бити означен према унапред договореној листи ознака
status: KOMPLETAN # један од: "IZRADA", "PREGLED" или "KOMPLETAN".
status-date: 2024-08-15 # датум у формату YYYY-MM-DD од када је задатак у наведеном статусу
crafted-dir: testcases
solutions:
  - name: ex0
    lang: [cpp]
    desc: ""
    tags: []
---

Змијко Рептил организује турнир у обарању руку. Како је он змија и нема руке, он неће учествовати. Учествоваће његових $N$ најбољих другова који су сви људи, где је $N$ **степен двојке**. Тачније, могуће је направити перфектан турнир без потребе да неко изостане из неког круга. Змијко је већ сваком од њих доделио јединствен број од $1$ до $N$. Познато је да $i$-ти друг има снагу $P_i$, као и да су све снаге различити бројеви из скупа $ \{ 1,2,\ldots ,N \} $.

<br>

Одвија се више кругова како би се изабрао победник. Нека у тренутном кругу турнира учествује $K$ другова. Руке обарају парови другова $(1,2),(3,4),\ldots (K-1,K)$. У наредни круг пролази онај са већом снагом у пару. Дакле, укупно $\frac{K}{2}$ другова учествује у наредном кругу и додељују им се нови бројеви на наредно наведен начин. Нека су $B_1 < B_2 < \ldots < B_{K/2}$ бројеви победника тренутног круга. Њихови нови бројеви су, редом, $1,2,\ldots \frac{K}{2}$. Напоменимо да они приликом ренумерације задржавају старе снаге. У првом кругу учествује $N$ другова, у другом $\frac{N}{2}$, у трећем $\frac{N}{4}$, $\ldots$ , у последњем $1$. Приметимо да, пошто је $N$ степен двојке, у сваком кругу учествује цео број другова, тј. увек је могуће правилно извршити дељење.

<br>

Змијко је познати преварант и он жели да један његов посебан друг освоји што бољи резултат. Победник је очито познат - то је друг са снагом $N$. Међутим, Змијку је довољно да последњи круг његовог миљеника буде што виши. Он ни сам не зна шта жели и двоуми се између $Q$ опција.

<br>

У свакој опцији познати су му миљеник $M_i$ и број $J_i$. Змијко има право да замени место било која два друга (који нису $M_i$ јер је то превише сумњиво) и тиме промени будући исход турнира. Дозвољено му је да то изврши **највише** $J_i$ пута пре почетка турнира. Након што турнир почне нема право да врши замене. При таквим условима, занима га највећи број круга до ког миљеник $M_i$ може стићи.

<br>

Пошто су ово ипак теоретске опције, оне се неће заправо извршавати. Самим тим сматрамо да се оне независно једна од друге одвијају.

<br>

## Опис улаза

<br>

У првом реду стандардног улаза, дат је цео број $N$ - број Змијкових другова који учествују у турниру обарања руку. Гарантује се да је $N$ **степен двојке**.

<br>

У другом реду стандардног улаза, дато је $N$ целих бројева $P_1,P_2,\ldots,P_N$ - снаге другова.

<br>

У трећем реду стандардног улаза, дат је цео број $Q$ - број опција које Змијко разматра.

<br>

У $i$-том од наредних $Q$ редова, дата су два цела броја $M_i$ и $J_i$.

<br>

## Опис излаза

<br>

Исписати $Q$ редова. У $i$-том од њих исписати највиши круг до који миљеник може стићи.

<br>
 
## Ограничења

<br>

- $4 \leq N \leq 2^{20}$, $N$ је степен двојке,
- $1 \leq Q \leq 5\cdot 10^5$,
- $1 \leq P_i \leq N$, наведени бројеви су међусобно различити,
- $1 \leq M_i \leq N$,
- $0 \leq J_i \leq N$.

<br>

Тест примери су подељени у пет дисјунктних група:
- У тестовима вредним 8 поена: $N = 4$.
- У тестовима вредним 16 поена: Важи $P_i = i$ за сваког друга.
- У тестовима вредним 16 поена: Важи $M_i = M_j$ за свака два цела броја $1 \leq i,j \leq Q$. Тачније, миљеник је исти у свакој опцији.
- У тестовима вредним 44 поена: $N \leq 2^{17}$, $Q \leq 10^5$.
- У тестовима вредним 16 поена: Без додатних ограничења.

<br>

## Пример 1

<br>

### Улаз

<br>

```
8
1 8 2 7 4 6 3 5
4
1 8
3 1
5 2
5 1
```

<br>

### Излаз

<br>

```
1
2
3
2
```

<br>

### Објашњење

<br>

У првој опцији, друг број $1$ има снагу $1$. Он не може победити никога другог јер има најмању снагу, те игру завршава у првом кругу.

<br>

У другој опцији, друг број $3$ има снагу $2$. Спречавамо обарање руку са другом $4$ који има снагу $7$ тако што њега мењамо са другом $1$ снаге $1$. Приликом обарања руку, миљеник побеђује и тиме се пласира у други круг. Доказује се да је то и највиши круг до ког може стићи.

<br>

У трећој опцији, мењамо другове $6$ и $8$ са, редом, друговима $1$ и $3$. Тиме друг $5$, миљеник, стиже до трећег круга.

<br>

## Пример 2

<br>

### Улаз

<br>

```
4
1 2 3 4
4
1 1
2 1
3 1
4 1
```

<br>

### Излаз

<br>

```
1
2
2
3
```

<br>

### Објашњење

<br>

У четвртој опцији, друг $4$ има снагу $4$ и он засигурно побеђује турнир. У првом кругу учествује $4$ друга, у дргом $2$, а за трећи круг можемо рећи да учествује само $1$ (иако се тај круг не наставља). Зато кажемо да је $3$ одговор за четврту опцију.

