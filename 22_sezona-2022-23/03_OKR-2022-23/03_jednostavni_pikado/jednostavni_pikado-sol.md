---
title: Једноставни пикадо - опис решења
---

# Једноставни пикадо

Аутор: Момчило Тошић
Текст и тест примери: Момчило Тошић
Тестирање: Алекса Милисављевић
Анализа решења: Момчило Тошић

### Анализа

Уочимо да Бане добија поене само ако изабере тачку са $x$ координатом међу унетим $x$ координатама, и са $y$ координатом која такође припада некој од контролних тачака.
Дакле, за решење за првих $i$ тачака бирамо $x_A$ из скупа $x_1,x_2,\ldots x_i$ и $y_A$ из скупа $y_1,y_2,\ldots y_i$ такве да је описана сума максимална.

### Решење у $O(M^4)$

За свако $i \leq M$ потребно је итерирати кроз све могуће парове $x_A,y_A$ из поменутих скупова (квадратна сложеност) и пронаћи збир из задатка (линеарна сложеност).
Укупно је потребно $O(M^4)$ корака.

### Решење у $O(M^3)$

Фиксирајмо $x$ координату. Тада је формула за број поена који максимизујемо у облику $\sum_{j=1}^{i} const*|y_j-y_A|$

Интуиција нам говори да ова сума „одлази у бесконачност“ када изабрана ипсилон координата или велика (ка бесконачности) или мала (ка минус бесконачности) те можемо покушати само вредност највећег $y_j$ и најмањег $y_j$, што даје брже решење јер радимо исто као у прошлом подзадатку само проверавамо две вредности за $y$ (минимум и максимум
ажурирамо како се уносе нове тачке). 

### Решење у $O(M^2)$

Докажимо интуицију из претходног решења. Доказаћемо грамзив приступ тако што докажемо да увек можемо добити решење које није лошије тако што уместо неке ипсилон координате изаберемо неку мању или већу (и стога је најбоље бирати најмању или највећу).

Нека су сви $y$ једнако размакнути (ово није проблематична претпоставка, наиме, ако нису, додавањем фиктивних међувредности ништа не мењамо јер ове вредности дају скор 0).
Фиксијармо $x$ координату и посматрајмо решење за $N$ тачака и одабрано $y=y_i$. Тада посматрајмо како се сума мења ако одаберемо $y$ координату лево, односно десно, од
$y_i$.
Наиме, ако је фиксирано $x$, сума је у облику $\sum_{j=1}^{N} const*|y_j-y_i|$

Покушајмо сада да видимо шта се дешава када
изабрану ипсилон координату „померимо“ за $\Delta y$ које је разлика двеју ипсилон координата (даље формуле не зависе од тога да ли је позитивно или негативно). 

Нека су и без губљења општости ипсилон координате уређене тако да је првих $i-1$ мање од $y_i$, а између $i$ и $k$ су једнаке, док су након $k$ веће. 
Тада ће сума бити ($const$ представљају позитивне константе - апсолутне разлике $x$ координата и фиксиране $x$ коорд.)
$\sum_{j=1}^{N} const*|y_j+\Delta y-y_i| = \sum_{j=1}^{i-1} const*(y_i-y_j-\Delta y)+\sum_{j=k}^{N} const*(y_j+\Delta y-y_i) + (k-i)*const*|\Delta y|$
Издвојимо претходну суму:
$ \sum_{j=1}^{N} const*|y_j-y_i| - \sum_{j=1}^{k} const*\Delta y + \sum_{j=k+1}^{i} const*\Delta y + const*|\Delta y| = \sum_{j=1}^{i} const*|y_j-y_A| + P_i*\Delta y + Q_i*|\Delta y| $
Видимо да се Банетов скор променио за $P_i*\Delta y + Q_i*|\Delta y|$.

Да ли је $P_i$ позитиван, негативан, или нула не зависи од тога да ли покушавамо да се "померимо" у лево или у десно већ само од икс вредности. Како је $Q_i$ увек ненегатино,
то је $P_i*\Delta y + Q_i*|\Delta y|$ у зависности од знака $\Delta y$ (позитивно представља померање у десно, ка највећем $y$, а негативно у лево, ка најмањем) или у оба случаја ненегативна вредност, или у једном случају негативна, а у другом ненегативна. Свакако, можемо одабрати оно $y$ за које је ова вредност ненегативна, односно Банетов скор није мањи, и стога се "померити" ка највећем или најмањем $y$. Индуктивно следи да највеће или најмање $y$ које можемо да одаберемо и дају најбоље решење.

Ако сада фиксирамо $y$, због потпуно симетричног израза, аналогно доказујемо да треба одабрати најмање или највеће $x$.
Избор једне координате не зависи од избора друге, те долазимо до закључка да постоји само 4 могућности за $x_A,y_A$ а то су највећа и најмања $x$ и $y$ координата.

Ове четири суме можемо израчунати за сваки префикс низа тачака, или искористити идеју раздвајања на две суме из доказа за пун број поена.

### Решење у $O(M)$

Уочимо да ако бирамо екстремне вредности $x$ и $y$ координата суме губе апсолутне заграде и могу се расписати тако да у њима факторишу 
$\sum_{i=1}^{N}x_i*y_i$, 
$x_A*\sum_{i=1}^{N}y_i$, 
$y_A*\sum_{i=1}^{N}y_i$ и 
$y_A*x_A$, те се 4 могуће суме могу израчунати у константој сложености ако се суме из ових фактора ажурирају приликом уноса сваке нове тачке.
